<div class="formulario-content">
  <div class="container">
    <div class="formulario-card">
      <form [formGroup]="config.formGroup" (ngSubmit)="funcionGuardarCambio()" novalidate>

        @for (field of config.fields; track field.name) {
          <div class="form-group">
            <label [for]="field.name">{{ field.label }}</label>

            @if (field.type === 'select') {
              <select 
                class="form-control" 
                [id]="field.name" 
                [name]="field.name" 
                [required]="field.required || false"
                [formControlName]="field.formControlName">
                
                @for (option of field.options; track option.value) {
                  <option [ngValue]="option.value" [disabled]="option.disabled">{{ option.label }}</option>
                }
              </select>
            } @else if (field.type === 'textarea') {
              <textarea
                class="form-control textarea"
                [id]="field.name"
                [name]="field.name"
                [placeholder]="field.placeholder"
                [required]="field.required"
                [formControlName]="field.formControlName"></textarea>
            } @else if (field.type === 'file') {
              @if (archivo) {
                <div class="archivo-actual mb-2">
                  <small class="text-muted">Archivo actual: <strong>{{ archivo }}</strong></small>
                </div>
              }
              <input 
                type="file" 
                class="form-control"
                [id]="field.name"
                [name]="field.name"
                [placeholder]="field.placeholder"
                [required]="field.required"
                (change)="onFileChange($event, field.formControlName)"
                [accept]="field.accept || ''">
            } @else {
              <input 
                [type]="field.type" 
                class="form-control"
                [id]="field.name"
                [name]="field.name"
                [placeholder]="field.placeholder"
                [required]="field.required"
                [formControlName]="field.formControlName"
                [readonly]="field.readonly || false">
            }
          </div>
        }

        <div class="row mt-4">
          <div class="col-md-6">
            @if (isFunction(config.cancelRoute)) {
              <button 
                type="button"
                (click)="config.cancelRoute()" 
                class="btn btn-cancelar">
                <i class="fas fa-times me-2"></i>CANCELAR
              </button>
            } @else {
              <a 
                [routerLink]="config.cancelRoute" 
                class="btn btn-cancelar">
                <i class="fas fa-times me-2"></i>CANCELAR
              </a>
            }
          </div>
          <div class="col-md-6 text-end">
            <button 
                type="submit" 
                class="btn btn-guardar">
                <i class="fas fa-save me-2"></i>{{ config.submitText }}
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>